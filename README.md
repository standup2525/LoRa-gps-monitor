# LoRa-gps-monitor
# ðŸŒ RPi SensorHub (ë¼ì¦ˆë² ë¦¬íŒŒì´ ì‹¤ì‹œê°„ ì„¼ì„œ ìœµí•© ì‹œìŠ¤í…œ)

> **Raspberry Pi 5 + GPS + LoRa + LTR390 + BME280 ê¸°ë°˜ ì‹¤ì‹œê°„ í™˜ê²½ ë°ì´í„° ìˆ˜ì§‘Â·ì‹œê°í™” í”Œëž«í¼**

ë³¸ í”„ë¡œì íŠ¸ëŠ” ë¼ì¦ˆë² ë¦¬íŒŒì´ì—ì„œ ë‹¤ì¤‘ ì„¼ì„œ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ê³ , ì‹¤ë‚´Â·ì‹¤ì™¸ í™˜ê²½ì„ íŒë³„í•˜ë©°,  
Flask + WebSocket ì„œë²„ë¥¼ í†µí•´ ì‹¤ì‹œê°„ìœ¼ë¡œ ì›¹ ëŒ€ì‹œë³´ë“œì— ì‹œê°í™”í•˜ëŠ” IoT ì‹œìŠ¤í…œìž…ë‹ˆë‹¤.  

---

## ðŸ§© ì‹œìŠ¤í…œ ê°œìš”

### êµ¬ì„±ë„
[ì„¼ì„œ ëª¨ë“ˆ]
â”œâ”€ LTR390 (ìžì™¸ì„ /ì¡°ë„)

â”œâ”€ BME280 (ì˜¨ë„/ìŠµë„/ê¸°ì••)

â”œâ”€ GPS (L80-R, CP2102 USB-UART)

â””â”€ LoRa ëª¨ë“ˆ (RYLR998 / E22-230T22U ë“±)

[ë¼ì¦ˆë² ë¦¬íŒŒì´5]
â”œâ”€ websocket.py â†’ ì‹¤ì‹œê°„ ë°ì´í„° ìˆ˜ì§‘, GPS/LoRa í†µì‹ , WebSocket ì†¡ì‹ 

â”œâ”€ flask.py â†’ DB ê´€ë¦¬ ë° REST API, CSV Export, ì›¹ì„œë²„

â””â”€ new.html â†’ ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œ UI

[ì›¹ í´ë¼ì´ì–¸íŠ¸]
â””â”€ ì‹¤ì‹œê°„ ìƒíƒœ, DB ë¡œê·¸ ì¡°íšŒ, CSV ë‹¤ìš´ë¡œë“œ, ë¼ë²¨ë§(Indoor/Outdoor)

yaml
ì½”ë“œ ë³µì‚¬

---

## âš™ï¸ ì£¼ìš” ê¸°ëŠ¥

| êµ¬ë¶„ | ì„¤ëª… |
|------|------|
| ðŸŒ **ì‹¤ì‹œê°„ WebSocket ì†¡ì‹ ** | 1ì´ˆ ê°„ê²©ìœ¼ë¡œ ì„¼ì„œ ë°ì´í„°ë¥¼ ì›¹ìœ¼ë¡œ ì „ì†¡ |

| ðŸ“Š **Flask REST API** | DB ì¡°íšŒ, í†µê³„, CSV Export ê¸°ëŠ¥ ì œê³µ |

| ðŸ’¾ **SQLite ë¡œì»¬ DB** | `sensor_log` í…Œì´ë¸”ì— ëª¨ë“  ì„¼ì„œê°’ ìžë™ ì €ìž¥ |

| ðŸ›°ï¸ **GPS ê¸°ë°˜ ì¢Œí‘œ ìˆ˜ì§‘** | NMEA íŒŒì‹±ìœ¼ë¡œ ìœ íš¨ì„±(A/V) ë° ìœ„ë„Â·ê²½ë„ ì¶”ì¶œ |

| ðŸ“¡ **LoRa í†µì‹ ** | ì†¡ìˆ˜ì‹  ë°ì´í„° ì²˜ë¦¬ ë° ê±°ë¦¬ ê³„ì‚° (Haversine ê³µì‹) |

| ðŸ  **ì‹¤ë‚´/ì‹¤ì™¸ íŒë³„ ì•Œê³ ë¦¬ì¦˜** | ì¡°ë„Â·ê¸°ì••Â·ìžì™¸ì„ Â·GPS fix ìƒíƒœ ê¸°ë°˜ í™˜ê²½ ë¶„ë¥˜ |

| ðŸ“ˆ **ì›¹ ëŒ€ì‹œë³´ë“œ ì‹œê°í™”** | ì‹¤ì‹œê°„ ì„¼ì„œê°’ í‘œì‹œ + DB ê²€ìƒ‰/CSV ë‹¤ìš´ë¡œë“œ UI |

| âš¡ **LoRa ì†ë„ í…ŒìŠ¤íŠ¸ ëª¨ë“œ** | WebSocket ëª…ë ¹(`start_test`)ìœ¼ë¡œ íŒ¨í‚· ì „ì†¡ ì„±ëŠ¥ ì¸¡ì • |

---

## ðŸ—‚ï¸ ë””ë ‰í„°ë¦¬ êµ¬ì¡°

ðŸ“ main/
â”œâ”€â”€ websocket.py # WebSocket + ì„¼ì„œ ìˆ˜ì§‘ ì„œë²„

â”œâ”€â”€ flask.py # Flask REST API ì„œë²„

â”œâ”€â”€ web/

â”‚ â””â”€â”€ new.html # ëŒ€ì‹œë³´ë“œ UI (TailwindCSS)

â””â”€â”€ totallogs/

â”œâ”€â”€ sensor.db # SQLite ë°ì´í„°ë² ì´ìŠ¤

â””â”€â”€ sensor.log # ì‹¤í–‰ ë¡œê·¸

yaml
ì½”ë“œ ë³µì‚¬

---

## ðŸ§  ì‹¤ë‚´/ì‹¤ì™¸ íŒë³„ ì•Œê³ ë¦¬ì¦˜

ì„¼ì„œ ë°ì´í„°ì™€ ì‹œê°„ëŒ€ ì •ë³´ë¥¼ ê²°í•©í•˜ì—¬ ì ìˆ˜(`OutdoorScore`)ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.

\[
\text{Score} =
\begin{cases}
0.5G + 0.3U + 0.15L + 0.05P, & \text{(ì£¼ê°„)} \\
0.7G + 0.2L + 0.1P, & \text{(ì•¼ê°„)}
\end{cases}
\]

| í•­ëª© | ì„¤ëª… |
|------|------|
| G | GPS Fix ìƒíƒœ (A=1, V=0) |
| U | UV Index (0~1.0 ì •ê·œí™”) |
| L | ì¡°ë„(Lux, ì£¼ê°„/ì•¼ê°„ ê°€ì¤‘ì¹˜ ë‹¤ë¦„) |
| P | ê¸°ì•• ë³€ë™ ê¸°ë°˜ ì‹¤ë‚´ ì¶”ì • (Î”P > 1.5 â†’ ì‹¤ë‚´) |

íŒë³„ ê¸°ì¤€  
- **Score > 0.6 â†’ ì‹¤ì™¸**  
- **Score < 0.4 â†’ ì‹¤ë‚´**  
- **ê·¸ ì™¸ â†’ ì „ì´(ì¶œìž… ì¤‘)**

---

## ðŸ’» ì‹¤í–‰ ë°©ë²•

### 1ï¸âƒ£ Python í™˜ê²½ êµ¬ì„±

    sudo apt update
    sudo apt install python3-pip python3-venv
    python3 -m venv ltr390env
    source ltr390env/bin/activate
    pip install flask websockets adafruit-circuitpython-ltr390 adafruit-circuitpython-bme280 pyserial

2ï¸âƒ£ Flask ì„œë²„ ì‹¤í–‰

    python3 flask.py
    
# â†’ http://ë¼ì¦ˆ`ë² ë¦¬íŒŒì´IP:8080 ì ‘ì†
3ï¸âƒ£ WebSocket ì„¼ì„œ ì„œë²„ ì‹¤í–‰

    python3 websocket.py

# â†’ ì„¼ì„œ ìˆ˜ì§‘ + ì‹¤ì‹œê°„ ì†¡ì‹  ì‹œìž‘
ðŸ“Š ì›¹ ëŒ€ì‹œë³´ë“œ ì£¼ìš” í™”ë©´
ì‹¤ì‹œê°„ ì„¼ì„œ ëª¨ë‹ˆí„°ë§ (GPS, UV, Lux, Pressure)

LoRa ìƒíƒœ ë° ê±°ë¦¬ í‘œì‹œ

DB ì¡°íšŒ ë° CSV ë‚´ë³´ë‚´ê¸°

ì‹¤ë‚´/ì‹¤ì™¸ ë¼ë²¨ë§ ë²„íŠ¼ (Indoor / Outdoor / SemiOutdoor)

ìµœê³ ì†ë„(LoRa ì†¡ì‹  ì†ë„) ì¸¡ì • ê¸°ëŠ¥

ðŸ“ ì£¼ìš” API
Method	Endpoint	ì„¤ëª…
GET	/api/data?start=&end=	ì‹œê°„ êµ¬ê°„ë³„ ë°ì´í„° ì¡°íšŒ
GET	/api/summary	ì„¼ì„œ ë°ì´í„° í†µê³„ ìš”ì•½
GET	/api/export_csv	CSV ë‹¤ìš´ë¡œë“œ
POST	/api/label	í˜„ìž¬ ì„¼ì„œë°ì´í„°ì— ë¼ë²¨ ì €ìž¥
GET	/api/label_data?label=	íŠ¹ì • ë¼ë²¨ ë°ì´í„° ì¡°íšŒ

ðŸ§ª ë°ì´í„° ì˜ˆì‹œ
timestamp	gps_fix	uv	lux	pressure	state	score
2025-10-22 13:11:42	A	0.32	558	1019.78	ì‹¤ì™¸	0.742
2025-10-22 13:12:43	V	0.02	430	1019.99	ì‹¤ë‚´	0.181

ðŸ“Ž í–¥í›„ ê³„íš
 TensorFlow Lite ê¸°ë°˜ ì‹¤ë‚´/ì™¸ ìžë™ í•™ìŠµ ëª¨ë¸ ì ìš©

 LoRa ì–‘ë°©í–¥ ì‹ í˜¸ í’ˆì§ˆ ë¶„ì„ (RSSI/SNR)

 ëŒ€ì‹œë³´ë“œ ë‹¤ì¤‘ í´ë¼ì´ì–¸íŠ¸ ì§€ì› ë° ì‹œê°í™” ê°œì„ 

 MQTT / InfluxDB / Grafana ì—°ë™

ðŸ§‘â€ðŸ’» ê°œë°œí™˜ê²½
í•­ëª©	ë‚´ìš©
ë³´ë“œ	Raspberry Pi 5
ì–¸ì–´	Python 3.11
ì›¹í”„ë ˆìž„ì›Œí¬	Flask, WebSocket
ë°ì´í„°ë² ì´ìŠ¤	SQLite3
í”„ë¡ íŠ¸ì—”ë“œ	TailwindCSS + JS (Vanilla)
ì„¼ì„œ	LTR390 / BME280 / GPS(L80-R) / LoRa(E22-230T22U)

ðŸ“œ ë¼ì´ì„ ìŠ¤
ë³¸ í”„ë¡œì íŠ¸ëŠ” MIT License í•˜ì— ë°°í¬ë©ë‹ˆë‹¤.
